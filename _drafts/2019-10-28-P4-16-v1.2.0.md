---
layout: post
title: "P4-16 v1.2.0 Released"
author: "Mihai Budiu and Nate Foster"
category: p4
header-img: assets/p4-background.png
---

# Introduction

On behalf of the entire P4 Language Design Working Group, we are
pleased to announce version 1.2.0 of the P4<sub>16</sub> Language
Specification! The official specification document is available in
[HTML](https://p4.org/p4-spec/docs/P4-16-v1.2.0.html) and
[PDF](https://p4.org/p4-spec/docs/P4-16-v1.2.0.pdf) formats.

# New Features

Following is a summary of the main changes made in this version of the
language.

## String and Int Types

The language now exposes `string` and `int` types to programmers.
Previously these types were only used internally by the compiler to
type check string and integer literals.

The string type is useful for specifying the type of `extern`
functions such as,
```
extern void log(string message);
``` 
which might add debugging information to a log on a software switch.

Similarly, the `int` type is useful for specifying the type
constructor parameters that control the size of elements such as
tables:
```
control c(...)(int n) {
  table t {
    ...
    size = n;
  } 
}
```
Note that to ensure that strings do not require excessive run-time
computation, `int` and `string` can only be used with compile-time
known values---i.e., literals and operations involving literals.

# Bit Types

We have clarified that the language supports 1-bit signed values. We
have also clarified that bit slices are always unsigned, even if the
underlying type being sliced was signed. For example, after evaluating
the following declarations,
```
int<9> x = -1;
bit<1> b = x[9:9];
```
the value of `b` will be `1`


# Casts on Enum Values

For `enum` values with a specified underlying type, such as 
```
enum bit<2> E {
  A = 0;
  B = 1;
  C = 2;
  D = 3;
}
```
the language now automatically casts values to the underlying type.
For example:
```
E e = A;
bit<2> b = e;
```
We expect that a common use of this feature is for writing parsers
that handle headers whose fields are specified using enum types.
Previously a cast was required when `select`ing on such fields, but
now the types are converted automatically.

# Header Type Sizes

As a convenience to programmers, the language now offers two
operations to calculate the size of a header type, `h.minSizeInBits()`
and `h.minSizeInBytes()`. These operations are similar to `sizeof` in
C and C++. Note however that the precise size may not be a
compile-time known value due to the `varbit` type.

# Annotations

Annotations provide a mechanism for extending the language in limited
ways, without having to modify the grammar. To accommodate a wide
range of annotations, some of which are target-specific, we have
relaxed the syntax of annotations so that they may contain any
sequence of terminals, so long as any parentheses are balanced.

At the same time, some standardized annotations may mandate specific
structure---e.g., the `@name` annotation has a string as its body
while the `pkginfo` annotation used by P4Runtime takes a list of
key-value pairs. We imagine that in the future, the structure of other
annotations may become de facto or official standards.

# Acknowledgments

As always, developing this new version of the language specification
was a community effort. It represents many months of hard work by the
entire P4 Language Design Working Group. Please see the minutes from
our monthly meetings, which are posted on the [LDWG
Next](https://github.com/p4lang/p4-spec/wiki/Language-Design-Working-Group)
for details about the key contributors.

# Next Steps

We plan to release version 1.3.0 of the specification in late spring
2020. The Language Design Working Group is already discussing several
features to focus on for this release including a module system, more
detailed descriptions of architecture behavior, enhanced run-time APIs
for `extern` functions and objects, among other features. 

If you'd like to get involved, please sign up for the [P4
Design](https://lists.p4.org/mailman/listinfo/p4-design_lists.p4.org)
mailing list, or join our monthly meetings. We typically meet on the
first Monday of each month at 10am PT. See the [P4 Working Group
Calendar](https://calendar.google.com/calendar?cid=ajR0bzQycnNqcXRma3MwcWI3aWFoOGdvdXNAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ)
for details.
